`timescale 1ns / 1ps
//////////////////////////////////////////////////////////////////////////////////
// Company: 
// Engineer: 
// 
// Create Date: 2022/10/01 16:52:36
// Design Name: 
// Module Name: cube
// Project Name: 
// Target Devices: 
// Tool Versions: 
// Description: 
// 
// Dependencies: 
// 
// Revision:
// Revision 0.01 - File Created
// Additional Comments:
// 
//////////////////////////////////////////////////////////////////////////////////

module CUBE(
    input clk,
    input rst_n,
    input [4:0]KEY_Value,//矩阵键盘控制转动
    output reg [161:0]cube_state//魔方状态:6*9*3
    );
    reg [161:0]cube_nstate;//暂存魔方下一个状态
    //魔方色块颜色定义
    parameter WHITE  = 3'b000;
    parameter GREEN  = 3'b001;
    parameter ORANGE = 3'b010;
    parameter BLUE   = 3'b011;
    parameter RED    = 3'b100;
    parameter YELLOW = 3'b101;
    //魔方状态转换
    always@(posedge clk or negedge rst_n)begin
        if(!rst_n)begin
            cube_state <= {
                ORANGE,ORANGE,ORANGE,ORANGE,ORANGE,ORANGE,ORANGE,ORANGE,ORANGE,//B
                YELLOW,YELLOW,YELLOW,YELLOW,YELLOW,YELLOW,YELLOW,YELLOW,YELLOW,//D
                BLUE,BLUE,BLUE,BLUE,BLUE,BLUE,BLUE,BLUE,BLUE,                  //R
                RED,RED,RED,RED,RED,RED,RED,RED,RED,                           //F
                GREEN,GREEN,GREEN,GREEN,GREEN,GREEN,GREEN,GREEN,GREEN,         //L
                WHITE,WHITE,WHITE,WHITE,WHITE,WHITE,WHITE,WHITE,WHITE          //U
            };
        end
        else begin
            cube_state <= cube_nstate;
        end
    end
    //产生魔方下一个状态
    always@(*)begin
        case(KEY_Value)
            5'd0 :cube_nstate <= U(cube_state);
            5'd1 :cube_nstate <= D(cube_state);
            5'd2 :cube_nstate <= F(cube_state);
            5'd3 :cube_nstate <= B(cube_state);
            5'd4 :cube_nstate <= L(cube_state);
            5'd5 :cube_nstate <= R(cube_state);
           
            5'd6 :cube_nstate <= U2(cube_state);
            5'd7 :cube_nstate <= D2(cube_state);
            5'd8 :cube_nstate <= F2(cube_state);
            5'd9 :cube_nstate <= B2(cube_state);
            5'd10:cube_nstate <= L2(cube_state);
            5'd11:cube_nstate <= R2(cube_state);
            
            5'd12:cube_nstate <= Un(cube_state);
            5'd13:cube_nstate <= Dn(cube_state);
            5'd14:cube_nstate <= Fn(cube_state);
            5'd15:cube_nstate <= Bn(cube_state);
            5'd16:cube_nstate <= Ln(cube_state);
            5'd17:cube_nstate <= Rn(cube_state);
            
            default:cube_nstate <= cube_state;
        endcase
    end
    /*--------------------------转动函数定义-------------------------------*/
    function [161:0]U(
        input [161:0]c
    );
        U = {
            c[29:27],c[32:30],c[35:33],c[152:150],c[149:147],c[146:144],c[143:141],c[140:138],c[137:135],
            c[134:108],//D面未动
            c[107:105],c[104:102],c[101:99],c[98:96],c[95:93],c[92:90],c[155:153],c[158:156],c[161:159],
            c[80:78],c[77:75],c[74:72],c[71:69],c[68:66],c[65:63],c[89:87],c[86:84],c[83:81],
            c[53:51],c[50:48],c[47:45],c[44:42],c[41:39],c[38:36],c[62:60],c[59:57],c[56:54],
            c[8:6],c[17:15],c[26:24],c[5:3],c[14:12],c[23:21],c[2:0],c[11:9],c[20:18]
        };
    endfunction

    function [161:0]D(
        input [161:0]c
    );
        D = {
            c[161:159],c[158:156],c[155:153],c[152:150],c[149:147],c[146:144],c[101:99],c[104:102],c[107:105],
            c[116:114],c[125:123],c[134:132],c[113:111],c[122:120],c[131:129],c[110:108],c[119:117],c[128:126],
            c[80:78],c[77:75],c[74:72],c[98:96],c[95:93],c[92:90],c[89:87],c[86:84],c[83:81],
            c[53:51],c[50:48],c[47:45],c[71:69],c[68:66],c[65:63],c[62:60],c[59:57],c[56:54],
            c[137:135],c[140:138],c[143:141],c[44:42],c[41:39],c[38:36],c[35:33],c[32:30],c[29:27],
            c[26:0]//U面未动
        };
    endfunction

    function [161:0]F(
        input [161:0]c
    );
        F = {
            c[161:135],//B面未动
            c[134:132],c[131:129],c[128:126],c[125:123],c[122:120],c[119:117],c[83:81],c[92:90],c[101:99],
            c[107:105],c[104:102],c[26:24],c[98:96],c[95:93],c[23:21],c[89:87],c[86:84],c[20:18],
            c[62:60],c[71:69],c[80:78],c[59:57],c[68:66],c[77:75],c[56:54],c[65:63],c[74:72],
            c[116:114],c[50:48],c[47:45],c[113:111],c[41:39],c[38:36],c[110:108],c[32:30],c[29:27],
            c[35:33],c[44:42],c[53:51],c[17:15],c[14:12],c[11:9],c[8:6],c[5:3],c[2:0]
        };
    endfunction

    function [161:0]B(
        input [161:0]c
    );
        B = {
            c[143:141],c[152:150],c[161:159],c[140:138],c[149:147],c[158:156],c[137:135],c[146:144],c[155:153],
            c[47:45],c[38:36],c[29:27],c[125:123],c[122:120],c[119:117],c[116:114],c[113:111],c[110:108],
            c[128:126],c[104:102],c[101:99],c[131:129],c[95:93],c[92:90],c[134:132],c[86:84],c[83:81],
            c[80:54],//F面未动
            c[53:51],c[50:48],c[2:0],c[44:42],c[41:39],c[5:3],c[35:33],c[32:30],c[8:6],
            c[26:24],c[23:21],c[20:18],c[17:15],c[14:12],c[11:9],c[107:105],c[98:96],c[89:87]
        };
    endfunction

    function [161:0]L(
        input [161:0]c
    );
        L = {
            c[161:159],c[158:156],c[128:126],c[152:150],c[149:147],c[119:117],c[143:141],c[140:138],c[110:108],
            c[134:132],c[131:129],c[74:72],c[125:123],c[122:120],c[65:63],c[116:114],c[113:111],c[56:54],
            c[107:81],//R面未动
            c[80:78],c[77:75],c[20:18],c[71:69],c[68:66],c[11:9],c[62:60],c[59:57],c[2:0],
            c[35:33],c[44:42],c[53:51],c[32:30],c[41:39],c[50:48],c[29:27],c[38:36],c[47:45],
            c[26:24],c[23:21],c[155:153],c[17:15],c[14:12],c[146:144],c[8:6],c[5:3],c[137:135]
        };
    endfunction

    function [161:0]R(
        input [161:0]c
    );
        R = {
            c[26:24],c[158:156],c[155:153],c[17:15],c[149:147],c[146:144],c[8:6],c[140:138],c[137:135],
            c[161:159],c[131:129],c[128:126],c[152:150],c[122:120],c[119:117],c[143:141],c[113:111],c[110:108],
            c[89:87],c[98:96],c[107:105],c[86:84],c[95:93],c[104:102],c[83:81],c[92:90],c[101:99],
            c[134:132],c[77:75],c[74:72],c[125:123],c[68:66],c[65:63],c[116:114],c[59:57],c[56:54],
            c[53:27],//L面未动
            c[80:78],c[23:21],c[20:18],c[71:69],c[14:12],c[11:9],c[62:60],c[5:3],c[2:0]
        };
    endfunction

    function [161:0]U2(
        input [161:0]c
    );
        U2 = {
            c[56:54],c[59:57],c[62:60],c[152:150],c[149:147],c[146:144],c[143:141],c[140:138],c[137:135],
            c[134:108],//D面未动
            c[107:105],c[104:102],c[101:99],c[98:96],c[95:93],c[92:90],c[35:33],c[32:30],c[29:27],
            c[80:78],c[77:75],c[74:72],c[71:69],c[68:66],c[65:63],c[155:153],c[158:156],c[161:159],
            c[53:51],c[50:48],c[47:45],c[44:42],c[41:39],c[38:36],c[89:87],c[86:84],c[83:81],
            c[2:0],c[5:3],c[8:6],c[11:9],c[14:12],c[17:15],c[20:18],c[23:21],c[26:24]
        };
    endfunction

    function [161:0]D2(
        input [161:0]c
    );
        D2 = {
            c[161:159],c[158:156],c[155:153],c[152:150],c[149:147],c[146:144],c[74:72],c[77:75],c[80:78],
            c[110:108],c[113:111],c[116:114],c[119:117],c[122:120],c[125:123],c[128:126],c[131:129],c[134:132],
            c[53:51],c[50:48],c[47:45],c[98:96],c[95:93],c[92:90],c[89:87],c[86:84],c[83:81],
            c[137:135],c[140:138],c[143:141],c[71:69],c[68:66],c[65:63],c[62:60],c[59:57],c[56:54],
            c[107:105],c[104:102],c[101:99],c[44:42],c[41:39],c[38:36],c[35:33],c[32:30],c[29:27],
            c[26:0]//U面未动
        };
    endfunction

    function [161:0]F2(
        input [161:0]c
    );
        F2 = {
            c[161:135],//B面未动
            c[134:132],c[131:129],c[128:126],c[125:123],c[122:120],c[119:117],c[20:18],c[23:21],c[26:24],
            c[107:105],c[104:102],c[35:33],c[98:96],c[95:93],c[44:42],c[89:87],c[86:84],c[53:51],
            c[56:54],c[59:57],c[59:57],c[65:63],c[68:66],c[71:69],c[74:72],c[77:75],c[80:78],
            c[83:81],c[50:48],c[47:45],c[92:90],c[41:39],c[38:36],c[101:99],c[32:30],c[29:27],
            c[110:108],c[113:111],c[116:114],c[17:15],c[14:12],c[11:9],c[8:6],c[5:3],c[2:0]
        };
    endfunction

    function [161:0]B2(
        input [161:0]c
    );
        B2 = {
            c[137:135],c[140:138],c[143:141],c[146:144],c[149:147],c[152:150],c[155:153],c[158:156],c[161:159],
            c[2:0],c[5:3],c[8:6],c[125:123],c[122:120],c[119:117],c[116:114],c[113:111],c[110:108],
            c[29:27],c[104:102],c[101:99],c[38:36],c[95:93],c[92:90],c[47:45],c[86:84],c[83:81],
            c[80:54],//F面未动
            c[53:51],c[50:48],c[89:87],c[44:42],c[41:39],c[98:96],c[35:33],c[32:30],c[107:105],
            c[26:24],c[23:21],c[20:18],c[17:15],c[14:12],c[11:9],c[128:126],c[131:129],c[134:132]
        };
    endfunction

    function [161:0]L2(
        input [161:0]c
    );
        L2 = {
            c[161:159],c[158:156],c[74:72],c[152:150],c[149:147],c[65:63],c[143:141],c[140:138],c[56:54],
            c[134:132],c[131:129],c[20:18],c[125:123],c[122:120],c[11:9],c[116:114],c[113:111],c[2:0],
            c[107:81],//R面未动
            c[80:78],c[77:75],c[155:153],c[71:69],c[68:66],c[146:144],c[62:60],c[59:57],c[137:135],
            c[29:27],c[32:30],c[35:33],c[38:36],c[41:39],c[44:42],c[47:45],c[50:48],c[53:51],
            c[26:24],c[23:21],c[128:126],c[17:15],c[14:12],c[119:117],c[8:6],c[5:3],c[110:108]
        };
    endfunction

    function [161:0]R2(
        input [161:0]c
    );
        R2 = {
            c[80:78],c[158:156],c[155:153],c[71:69],c[149:147],c[146:144],c[62:60],c[140:138],c[137:135],
            c[26:24],c[131:129],c[128:126],c[17:15],c[122:120],c[119:117],c[8:6],c[113:111],c[110:108],
            c[89:87],c[86:84],c[83:81],c[92:90],c[95:93],c[98:96],c[101:99],c[104:102],c[107:105],
            c[161:159],c[77:75],c[74:72],c[152:150],c[68:66],c[65:63],c[143:141],c[59:57],c[56:54],
            c[53:27],//L面未动
            c[134:132],c[23:21],c[20:18],c[125:123],c[14:12],c[11:9],c[116:114],c[5:3],c[2:0]
        };
    endfunction

    function [161:0]Un(
        input [161:0]c
    );
        Un = {
            c[83:81],c[86:84],c[89:87],c[152:150],c[149:147],c[146:144],c[143:141],c[140:138],c[137:135],
            c[134:108],//D面未动
            c[107:105],c[104:102],c[101:99],c[98:96],c[95:93],c[92:90],c[62:60],c[59:57],c[56:54],
            c[80:78],c[77:75],c[74:72],c[71:69],c[68:66],c[65:63],c[35:33],c[32:30],c[29:27],
            c[53:51],c[50:48],c[47:45],c[44:42],c[41:39],c[38:36],c[155:153],c[158:156],c[161:159],
            c[20:18],c[11:9],c[2:0],c[23:21],c[14:12],c[5:3],c[26:24],c[17:15],c[8:6]
        };
    endfunction

    function [161:0]Dn(
        input [161:0]c
    );
        Dn = {
            c[161:159],c[158:156],c[155:153],c[152:150],c[149:147],c[146:144],c[47:45],c[50:48],c[53:51],
            c[128:126],c[131:129],c[110:108],c[131:129],c[122:120],c[113:111],c[134:132],c[125:123],c[116:114],
            c[137:135],c[140:138],c[143:141],c[98:96],c[95:93],c[92:90],c[89:87],c[86:84],c[83:81],
            c[107:105],c[104:102],c[101:99],c[71:69],c[68:66],c[65:63],c[62:60],c[59:57],c[56:54],
            c[80:78],c[77:75],c[74:72],c[44:42],c[41:39],c[38:36],c[35:33],c[32:30],c[29:27],
            c[26:0]//U面未动
        };
    endfunction

    function [161:0]Fn(
        input [161:0]c
    );
        Fn = {
            c[161:135],//B面未动
            c[134:132],c[131:129],c[128:126],c[125:123],c[122:120],c[119:117],c[53:51],c[44:42],c[35:33],
            c[107:105],c[104:102],c[110:108],c[98:96],c[95:93],c[113:111],c[89:87],c[86:84],c[116:114],
            c[74:72],c[65:63],c[56:54],c[77:75],c[68:66],c[59:57],c[80:78],c[71:69],c[62:60],
            c[20:18],c[50:48],c[47:45],c[23:21],c[41:39],c[38:36],c[26:24],c[32:30],c[29:27],
            c[101:99],c[92:90],c[83:81],c[17:15],c[14:12],c[11:9],c[8:6],c[5:3],c[2:0]
        };
    endfunction

    function [161:0]Bn(
        input [161:0]c
    );
        Bn = {
            c[155:153],c[146:144],c[137:135],c[158:156],c[149:147],c[140:138],c[161:159],c[152:150],c[143:141],
            c[89:87],c[98:96],c[107:105],c[125:123],c[122:120],c[119:117],c[116:114],c[113:111],c[110:108],
            c[8:6],c[104:102],c[101:99],c[5:3],c[95:93],c[92:90],c[2:0],c[86:84],c[83:81],
            c[80:54],//F面未动
            c[53:51],c[50:48],c[134:132],c[44:42],c[41:39],c[131:129],c[35:33],c[32:30],c[128:126],
            c[26:24],c[23:21],c[20:18],c[17:15],c[14:12],c[11:9],c[29:27],c[38:36],c[47:45]
        };
    endfunction

    function [161:0]Ln(
        input [161:0]c
    );
        Ln = {
            c[161:159],c[158:156],c[20:18],c[152:150],c[149:147],c[11:9],c[143:141],c[140:138],c[2:0],
            c[134:132],c[131:129],c[155:153],c[125:123],c[122:120],c[146:144],c[116:114],c[113:111],c[137:135],
            c[107:81],//R面未动
            c[80:78],c[77:75],c[128:126],c[71:69],c[68:66],c[119:117],c[62:60],c[59:57],c[110:108],
            c[47:45],c[38:36],c[29:27],c[50:48],c[41:39],c[32:30],c[53:51],c[44:42],c[35:33],
            c[26:24],c[23:21],c[74:72],c[17:15],c[14:12],c[65:63],c[8:6],c[5:3],c[56:54]
        };
    endfunction

    function [161:0]Rn(
        input [161:0]c
    );
        Rn = {
            c[134:132],c[158:156],c[155:153],c[125:123],c[149:147],c[146:144],c[116:114],c[140:138],c[137:135],
            c[80:78],c[131:129],c[128:126],c[71:69],c[122:120],c[119:117],c[62:60],c[113:111],c[110:108],
            c[101:99],c[92:90],c[83:81],c[104:102],c[95:93],c[86:84],c[107:105],c[98:96],c[89:87],
            c[26:24],c[77:75],c[74:72],c[17:15],c[68:66],c[65:63],c[8:6],c[59:57],c[56:54],
            c[53:27],//L面未动
            c[161:159],c[23:21],c[20:18],c[152:150],c[14:12],c[11:9],c[143:141],c[5:3],c[2:0]
        };
    endfunction

endmodule

